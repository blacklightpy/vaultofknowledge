/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var b=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var S=(l,i)=>{for(var e in i)b(l,e,{get:i[e],enumerable:!0})},L=(l,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of y(i))!E.call(l,s)&&s!==e&&b(l,s,{get:()=>i[s],enumerable:!(t=T(i,s))||t.enumerable});return l};var M=l=>L(b({},"__esModule",{value:!0}),l);var x={};S(x,{default:()=>p});module.exports=M(x);var f=require("obsidian");var c={minWidth:40,closeButtonWidth:28,leftPadding:12,iconRightMargin:0,closeButtonPadding:0,transitionDuration:275,iconWidth:20,maxWidth:0};var d=require("obsidian");var m=class extends d.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),this.createSettingsUI(e)}createSettingsUI(e){[{name:"Close button padding",desc:"Space in pixels before close button",prop:"closeButtonPadding"},{name:"Transition duration",desc:"Duration in milliseconds for smooth transitions",prop:"transitionDuration"}].forEach(({name:t,desc:s,prop:a})=>{new d.Setting(e).setName(t).setDesc(`${s} (default: ${c[a]})`).addText(o=>o.setPlaceholder(String(c[a])).setValue(String(this.plugin.settings[a])).onChange(async n=>{let r=Number(n);!isNaN(r)&&r>=0&&(this.plugin.settings[a]=r,this.plugin.updateCSSVariables(),await this.plugin.saveSettings())}))}),this.createSettingsSection(e,"Basic dimensions",[{name:"Minimum width",desc:"Minimum width in pixels for very short titles",prop:"minWidth"},{name:"Max width",desc:"Maximum width in pixels for tabs (0 to disable)",prop:"maxWidth"},{name:"Close button width",desc:"Width in pixels for the tab close button",prop:"closeButtonWidth"},{name:"Left padding",desc:"Padding in pixels before the icon",prop:"leftPadding"}]),this.createSettingsSection(e,"Icons",[{name:"Icon width",desc:"Width in pixels for tab icons",prop:"iconWidth"},{name:"Icon right margin",desc:"Space in pixels between icon and text",prop:"iconRightMargin"}])}createSettingsSection(e,t,s){new d.Setting(e).setName(t).setHeading(),s.forEach(({name:a,desc:o,prop:n})=>{new d.Setting(e).setName(a).setDesc(`${o} (default: ${c[n]})`).addText(r=>r.setPlaceholder(String(c[n])).setValue(String(this.plugin.settings[n])).onChange(async h=>{let u=Number(h);!isNaN(u)&&u>=0&&(this.plugin.settings[n]=u,await this.plugin.saveSettings())}))})}};var g=class{constructor(i){this.tabWidthCache=new Map;this.observer=null;this.iconObserver=null;this.measureElement=null;this.debounceTimeout=null;this.scrollCheckInterval=null;this.isAdjustmentQueued=!1;this.isResetting=!1;this.plugin=i}initialize(){this.setupMeasureElement(),this.registerEventHandlers(),setTimeout(()=>{this.queueHeaderAdjustment(),this.setupMutationObserver(),this.setupIconStabilizationObserver(),this.setupScrollVisibilityCheck()},300)}cleanup(){this.tabWidthCache.clear(),this.observer&&this.observer.disconnect(),this.iconObserver&&this.iconObserver.disconnect(),this.measureElement&&this.measureElement.remove(),this.scrollCheckInterval&&window.clearInterval(this.scrollCheckInterval),document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner").forEach(t=>{t instanceof HTMLElement&&(t.style.overflowX="",t.style.overflowY="",t.scrollLeft=0)}),this.getAllHeaders().forEach(t=>{t.classList.add("autofit-cleanup"),t.classList.remove("autofit-tab"),t.classList.remove("autofit-max-width"),t.classList.remove("out-of-view"),t.style.removeProperty("--header-width"),setTimeout(()=>{t.classList.remove("autofit-cleanup")},this.plugin.settings.transitionDuration)})}setupMeasureElement(){this.measureElement=document.createElement("span"),this.measureElement.className="autofit-tab-measure",document.body.appendChild(this.measureElement)}setupMutationObserver(){let i=document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container");!i||i.length===0||(this.observer=new MutationObserver(e=>{for(let t of e)if(t.target&&t.target instanceof Element){if(!t.target.closest(".workspace-split.mod-vertical.mod-root"))continue;if(t.target.closest(".workspace-split.mod-vertical.mod-root .workspace-tab-header")||t.target.classList.contains("workspace-tab-header-inner-title")&&t.target.closest(".workspace-split.mod-vertical.mod-root")){this.queueHeaderAdjustment();return}if(t.target===document.body&&t.type==="attributes"&&t.attributeName==="class"){this.tabWidthCache.clear(),this.queueHeaderAdjustment();return}}}),document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container").forEach(e=>{this.observer&&this.observer.observe(e,{childList:!0,subtree:!0,attributes:!1,characterData:!0})}),this.observer&&this.observer.observe(document.body,{attributes:!0,attributeFilter:["class"]}))}setupIconStabilizationObserver(){this.iconObserver=new MutationObserver(i=>{for(let e of i)if(e.type==="childList"&&e.target instanceof Element&&e.target.classList.contains("workspace-tab-header-inner-icon")){let t=e.target.closest(".workspace-tab-header");t&&!t.classList.contains("is-active")&&(t.classList.add("icon-transition"),setTimeout(()=>{t&&t.classList.remove("icon-transition")},this.plugin.settings.transitionDuration))}}),document.querySelectorAll(".workspace-split.mod-vertical.mod-root").forEach(i=>{this.iconObserver&&this.iconObserver.observe(i,{childList:!0,subtree:!0})})}setupScrollVisibilityCheck(){this.updateTabsVisibility(),document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner").forEach(i=>{i instanceof HTMLElement&&i.addEventListener("scroll",()=>{this.updateTabsVisibility()},{passive:!0})}),this.scrollCheckInterval=window.setInterval(()=>{this.updateTabsVisibility()},1e3)}registerEventHandlers(){this.plugin.registerEvent(this.plugin.app.workspace.on("layout-change",()=>{this.debounceLayoutChange(),setTimeout(()=>this.updateTabsVisibility(),300)})),this.plugin.registerEvent(this.plugin.app.workspace.on("file-open",this.handleFileOpen.bind(this))),this.plugin.registerEvent(this.plugin.app.vault.on("rename",()=>{this.queueHeaderAdjustment()})),document.body.addEventListener("click",this.handleTabClick.bind(this)),this.plugin.register(()=>document.body.removeEventListener("click",this.handleTabClick.bind(this))),window.addEventListener("resize",()=>{this.updateTabsVisibility()},{passive:!0}),this.plugin.register(()=>window.removeEventListener("resize",()=>this.updateTabsVisibility()))}debounceLayoutChange(){this.debounceTimeout&&window.clearTimeout(this.debounceTimeout),this.debounceTimeout=window.setTimeout(()=>{this.queueHeaderAdjustment(),this.debounceTimeout=null},100)}handleTabClick(i){let e=i.target,t=e==null?void 0:e.closest(".workspace-split.mod-vertical.mod-root .workspace-tab-header");t&&t instanceof HTMLElement&&setTimeout(()=>{t.classList.contains("is-active")&&this.scrollToActiveTab(t)},50)}handleFileOpen(){document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header.is-active").forEach(e=>{e instanceof HTMLElement&&(this.stabilizeIcon(e),setTimeout(()=>{this.tabWidthCache.has(this.getHeaderKey(e))||this.queueHeaderAdjustment(),this.scrollToActiveTab(e)},50))})}stabilizeIcon(i){let e=i.querySelector(".workspace-tab-header-inner-icon");if(e){e.classList.add("stable-icon");let t=e.innerHTML,s=new MutationObserver(()=>{e.innerHTML!==t&&(e.innerHTML=t)});s.observe(e,{childList:!0,subtree:!0}),setTimeout(()=>{s.disconnect(),e.classList.remove("stable-icon")},this.plugin.settings.transitionDuration+50)}}preserveAllIcons(){this.getAllHeaders().forEach(e=>{let t=e.querySelector(".workspace-tab-header-inner-icon");t instanceof HTMLElement&&(t.style.pointerEvents="none")})}scrollToActiveTab(i){if(!i.closest(".workspace-split.mod-vertical.mod-root"))return;let e=i.closest(".workspace-tab-header-container-inner");if(e instanceof HTMLElement){let t=i.getBoundingClientRect(),s=e.getBoundingClientRect(),a=i.offsetLeft,o=a+t.width,n=e.scrollLeft,r=n+s.width;if(a<n||o>r){let h=a+t.width/2-s.width/2;this.smoothScrollTo(e,e.scrollLeft,Math.max(0,h),300)}setTimeout(()=>this.updateTabsVisibility(),this.plugin.settings.transitionDuration+50)}}smoothScrollTo(i,e,t,s){let a=performance.now(),o=r=>r<.5?2*r*r:1-Math.pow(-2*r+2,2)/2,n=r=>{let h=r-a,u=Math.min(h/s,1),v=o(u),w=e+(t-e)*v;i.scrollLeft=w,u<1&&requestAnimationFrame(n)};requestAnimationFrame(n)}queueHeaderAdjustment(){this.isAdjustmentQueued||(this.isAdjustmentQueued=!0,requestAnimationFrame(()=>{this.adjustAllHeaders(),this.updateTabsVisibility(),this.isAdjustmentQueued=!1}))}getAllHeaders(){return Array.from(document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header"))}getHeaderKey(i){let e=i.querySelector(".workspace-tab-header-inner-title");return(e==null?void 0:e.textContent)||""}measureTextWidth(i,e){if(!this.measureElement)return 0;let t=window.getComputedStyle(e);return this.measureElement.style.font=t.font,this.measureElement.style.letterSpacing=t.letterSpacing,this.measureElement.style.textTransform=t.textTransform,this.measureElement.style.fontWeight=t.fontWeight,this.measureElement.textContent=i,Math.ceil(this.measureElement.offsetWidth)+5}calculateHeaderWidth(i){let e=i.querySelector(".workspace-tab-header-inner-title");if(!e)return this.plugin.settings.minWidth;let t=this.measureTextWidth(e.textContent||"",e),s=this.plugin.settings.iconWidth>0?this.plugin.settings.iconWidth:0,a=Math.ceil(Math.max(this.plugin.settings.leftPadding+s+this.plugin.settings.iconRightMargin+t+this.plugin.settings.closeButtonPadding+this.plugin.settings.closeButtonWidth,this.plugin.settings.minWidth));return this.plugin.settings.maxWidth>0?Math.min(a,this.plugin.settings.maxWidth):a}adjustAllHeaders(){if(this.isResetting)return;let i=this.getAllHeaders().filter(s=>{let a=s.closest(".workspace-tab-header-container"),o=a&&window.getComputedStyle(a).display!=="none",n=!s.classList.contains("icon-loading");return o&&n}),e=new Map,t=null;i.forEach(s=>{let a=this.getHeaderKey(s),o=s.querySelector(".workspace-tab-header-inner-icon");o instanceof HTMLElement&&(o.style.pointerEvents="none",o.style.transform="translateZ(0)");let n=this.tabWidthCache.get(a);(n===void 0||s.classList.contains("is-active"))&&(n=this.calculateHeaderWidth(s)),s.classList.add("autofit-tab"),s.style.setProperty("--header-width",`${n}px`),e.set(a,n),this.plugin.settings.maxWidth>0&&n>=this.plugin.settings.maxWidth?(s.classList.add("autofit-max-width"),n=Math.min(n,this.plugin.settings.maxWidth+20),s.style.setProperty("--header-width",`${n}px`)):s.classList.remove("autofit-max-width"),s.classList.contains("is-active")&&(t=s)}),this.tabWidthCache=e,t?this.scrollToActiveTab(t):this.updateTabsVisibility()}resetTabs(i){this.isResetting=!0;let e=this.getAllHeaders();e.forEach(t=>{t.classList.remove("autofit-max-width"),t.classList.remove("autofit-tab"),t.classList.remove("out-of-view"),t.classList.add("autofit-cleanup"),t.style.removeProperty("--header-width")}),this.tabWidthCache.clear(),setTimeout(()=>{e.forEach(t=>{t.classList.remove("autofit-cleanup")}),setTimeout(()=>{e.forEach(t=>{t.classList.add("autofit-tab")}),this.adjustAllHeaders(),this.updateTabsVisibility(),this.isResetting=!1},50)},100)}updateTabsVisibility(){this.isResetting||document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner").forEach(i=>{if(i instanceof HTMLElement){let e=i.getBoundingClientRect(),t=e.left,s=e.right;Array.from(i.querySelectorAll(".workspace-tab-header.autofit-tab")).forEach(o=>{if(o instanceof HTMLElement){let n=o.getBoundingClientRect();n.right<t||n.left>s?o.classList.add("out-of-view"):o.classList.remove("out-of-view")}})}})}};var p=class extends f.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new m(this.app,this)),this.tabManager=new g(this),this.updateCSSVariables(),this.tabManager.initialize()}onunload(){this.tabManager.cleanup()}async loadSettings(){this.settings=Object.assign({},c,await this.loadData())}updateCSSVariables(){let e={"--autofit-min-width":`${this.settings.minWidth}px`,"--autofit-close-button-width":`${this.settings.closeButtonWidth}px`,"--autofit-left-padding":`${this.settings.leftPadding}px`,"--autofit-icon-right-margin":`${this.settings.iconRightMargin}px`,"--autofit-close-button-padding":`${this.settings.closeButtonPadding}px`,"--autofit-transition-duration":`${this.settings.transitionDuration}ms`,"--autofit-icon-width":`${this.settings.iconWidth}px`,"--autofit-icon-display":this.settings.iconWidth>0?"flex":"none","--autofit-max-width":this.settings.maxWidth>0?`${this.settings.maxWidth}px`:"none"};Object.entries(e).forEach(([t,s])=>{document.documentElement.style.setProperty(t,s)})}async saveSettings(){let e=this.settings.maxWidth;await this.saveData(this.settings),this.updateCSSVariables();let t=e>0&&this.settings.maxWidth===0;t?this.tabManager.resetTabs(t):this.tabManager.queueHeaderAdjustment()}};

/* nosourcemap */
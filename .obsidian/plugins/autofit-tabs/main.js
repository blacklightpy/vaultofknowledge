/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var w=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var k=(c,i)=>{for(var e in i)w(c,e,{get:i[e],enumerable:!0})},W=(c,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of E(i))!S.call(c,s)&&s!==e&&w(c,s,{get:()=>i[s],enumerable:!(t=L(i,s))||t.enumerable});return c};var M=c=>W(w({},"__esModule",{value:!0}),c);var P={};k(P,{default:()=>v});module.exports=M(P);var y=require("obsidian");var g={minWidth:40,leftPadding:12,closeButtonLeftPadding:30,closeButtonRightPadding:8,transitionDuration:375,iconWidth:20,maxWidth:0,ignorePinnedTabs:!1,hideTabIcons:!1,ignoreWebLinks:!0};var u=require("obsidian");var b=class extends u.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),this.createSettingsUI(e)}createSettingsUI(e){[{name:"Close button left padding",desc:"Space in pixels before close button",prop:"closeButtonLeftPadding"},{name:"Close button right padding",desc:"Space in pixels after close button",prop:"closeButtonRightPadding"},{name:"Transition duration",desc:"Duration in milliseconds for smooth transitions",prop:"transitionDuration"}].forEach(({name:t,desc:s,prop:n})=>{new u.Setting(e).setName(t).setDesc(`${s} (default: ${g[n]})`).addText(a=>a.setPlaceholder(String(g[n])).setValue(String(this.plugin.settings[n])).onChange(async o=>{let r=Number(o);!isNaN(r)&&r>=0&&(this.plugin.settings[n]=r,this.plugin.updateCSSVariables(),await this.plugin.saveSettings())}))}),new u.Setting(e).setName("Ignore pinned tabs").setDesc("Do not modify pinned tabs (keeps default behavior)").addToggle(t=>t.setValue(this.plugin.settings.ignorePinnedTabs).onChange(async s=>{this.plugin.settings.ignorePinnedTabs=s,await this.plugin.saveSettings()})),new u.Setting(e).setName("Ignore web links").setDesc("Do not modify tabs that are web links (keeps default behavior)").addToggle(t=>t.setValue(this.plugin.settings.ignoreWebLinks).onChange(async s=>{this.plugin.settings.ignoreWebLinks=s,await this.plugin.saveSettings()})),this.createSettingsSection(e,"Basic dimensions",[{name:"Minimum width",desc:"Minimum width in pixels for very short titles",prop:"minWidth"},{name:"Max width",desc:"Maximum width in pixels for tabs (0 to disable)",prop:"maxWidth"}]),this.createSettingsSection(e,"Icons",[{name:"Icon width",desc:"Width in pixels for tab icons",prop:"iconWidth"},{name:"Left padding",desc:"Padding in pixels before the icon",prop:"leftPadding"}]),new u.Setting(e).setName("Hide tab icons").setDesc("Hide all icons in tabs").addToggle(t=>t.setValue(this.plugin.settings.hideTabIcons).onChange(async s=>{this.plugin.settings.hideTabIcons=s,await this.plugin.saveSettings()}))}createSettingsSection(e,t,s){new u.Setting(e).setName(t).setHeading(),s.forEach(({name:n,desc:a,prop:o})=>{new u.Setting(e).setName(n).setDesc(`${a} (default: ${g[o]})`).addText(r=>r.setPlaceholder(String(g[o])).setValue(String(this.plugin.settings[o])).onChange(async d=>{let l=Number(d);!isNaN(l)&&l>=0&&(this.plugin.settings[o]=l,await this.plugin.saveSettings())}))})}};var f=class{constructor(i){this.tabWidthCache=new Map;this.observer=null;this.iconObserver=null;this.measureElement=null;this.debounceTimeout=null;this.scrollCheckInterval=null;this.isAdjustmentQueued=!1;this.isResetting=!1;this.plugin=i}initialize(){this.setupMeasureElement(),this.registerEventHandlers(),requestAnimationFrame(()=>{this.preCalculateAllTabWidths(),this.setupMutationObserver(),this.setupIconStabilizationObserver(),this.setupScrollVisibilityCheck(),this.queueHeaderAdjustment()})}preCalculateAllTabWidths(){this.getAllHeaders().forEach(e=>{let t=this.getHeaderKey(e);if(!this.tabWidthCache.has(t)){let s=this.calculateHeaderWidth(e);this.tabWidthCache.set(t,s)}})}cleanup(){this.tabWidthCache.clear(),this.observer&&this.observer.disconnect(),this.iconObserver&&this.iconObserver.disconnect(),this.measureElement&&this.measureElement.remove(),this.scrollCheckInterval&&window.clearInterval(this.scrollCheckInterval),document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner").forEach(t=>{t instanceof HTMLElement&&(t.style.overflowX="",t.style.overflowY="",t.scrollLeft=0)}),this.getAllHeaders().forEach(t=>{t.classList.add("autofit-cleanup"),t.classList.remove("autofit-tab"),t.classList.remove("autofit-max-width"),t.classList.remove("out-of-view"),t.style.removeProperty("--header-width"),setTimeout(()=>{t.classList.remove("autofit-cleanup")},this.plugin.settings.transitionDuration)})}setupMeasureElement(){this.measureElement=document.createElement("span"),this.measureElement.className="autofit-tab-measure",document.body.appendChild(this.measureElement)}setupMutationObserver(){let i=document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container");!i||i.length===0||(this.observer=new MutationObserver(e=>{for(let t of e)if(t.target&&t.target instanceof Element){if(!t.target.closest(".workspace-split.mod-vertical.mod-root"))continue;if(t.target.closest(".workspace-split.mod-vertical.mod-root .workspace-tab-header")||t.target.classList.contains("workspace-tab-header-inner-title")&&t.target.closest(".workspace-split.mod-vertical.mod-root")){this.queueHeaderAdjustment();return}if(t.target===document.body&&t.type==="attributes"&&t.attributeName==="class"){this.tabWidthCache.clear(),this.queueHeaderAdjustment();return}}}),document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container").forEach(e=>{this.observer&&this.observer.observe(e,{childList:!0,subtree:!0,attributes:!1,characterData:!0})}),this.observer&&this.observer.observe(document.body,{attributes:!0,attributeFilter:["class"]}))}setupIconStabilizationObserver(){this.iconObserver=new MutationObserver(i=>{for(let e of i)if(e.type==="childList"&&e.target instanceof Element&&e.target.classList.contains("workspace-tab-header-inner-icon")){let t=e.target.closest(".workspace-tab-header");t&&!t.classList.contains("is-active")&&(t.classList.add("icon-transition"),setTimeout(()=>{t&&t.classList.remove("icon-transition")},this.plugin.settings.transitionDuration))}}),document.querySelectorAll(".workspace-split.mod-vertical.mod-root").forEach(i=>{this.iconObserver&&this.iconObserver.observe(i,{childList:!0,subtree:!0})})}setupScrollVisibilityCheck(){this.updateTabsVisibility(),document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner").forEach(i=>{i instanceof HTMLElement&&i.addEventListener("scroll",()=>{this.updateTabsVisibility()},{passive:!0})}),this.scrollCheckInterval=window.setInterval(()=>{this.updateTabsVisibility()},1e3)}registerEventHandlers(){this.plugin.registerEvent(this.plugin.app.workspace.on("layout-change",()=>{this.debounceLayoutChange(),setTimeout(()=>this.updateTabsVisibility(),300)})),this.plugin.registerEvent(this.plugin.app.workspace.on("file-open",this.handleFileOpen.bind(this))),this.plugin.registerEvent(this.plugin.app.vault.on("rename",()=>{this.queueHeaderAdjustment()})),document.body.addEventListener("click",this.handleTabClick.bind(this)),this.plugin.register(()=>document.body.removeEventListener("click",this.handleTabClick.bind(this))),window.addEventListener("resize",()=>{this.updateTabsVisibility()},{passive:!0}),this.plugin.register(()=>window.removeEventListener("resize",()=>this.updateTabsVisibility()))}debounceLayoutChange(){this.debounceTimeout&&window.clearTimeout(this.debounceTimeout),this.debounceTimeout=window.setTimeout(()=>{this.queueHeaderAdjustment(),this.debounceTimeout=null},100)}handleTabClick(i){let e=i.target,t=e==null?void 0:e.closest(".workspace-split.mod-vertical.mod-root .workspace-tab-header");t&&t instanceof HTMLElement&&setTimeout(()=>{t.classList.contains("is-active")&&this.scrollToActiveTab(t)},50)}handleFileOpen(){document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header.is-active").forEach(e=>{e instanceof HTMLElement&&(this.stabilizeIcon(e),setTimeout(()=>{this.tabWidthCache.has(this.getHeaderKey(e))||this.queueHeaderAdjustment(),this.scrollToActiveTab(e)},50))})}stabilizeIcon(i){let e=i.querySelector(".workspace-tab-header-inner-icon");if(e){e.classList.add("stable-icon");let t=e.innerHTML,s=new MutationObserver(()=>{e.innerHTML!==t&&(e.innerHTML=t)});s.observe(e,{childList:!0,subtree:!0}),setTimeout(()=>{s.disconnect(),e.classList.remove("stable-icon")},this.plugin.settings.transitionDuration+50)}}preserveAllIcons(){this.getAllHeaders().forEach(e=>{let t=e.querySelector(".workspace-tab-header-inner-icon");t instanceof HTMLElement&&(t.style.pointerEvents="none")})}scrollToActiveTab(i){if(!i.closest(".workspace-split.mod-vertical.mod-root"))return;let e=i.closest(".workspace-tab-header-container-inner");if(e instanceof HTMLElement){let t=i.getBoundingClientRect(),s=e.getBoundingClientRect(),n=i.offsetLeft,a=n+t.width,o=e.scrollLeft,r=o+s.width;if(n<o||a>r){let d=n+t.width/2-s.width/2;this.smoothScrollTo(e,e.scrollLeft,Math.max(0,d),300)}setTimeout(()=>this.updateTabsVisibility(),this.plugin.settings.transitionDuration+50)}}smoothScrollTo(i,e,t,s){let n=performance.now(),a=r=>r<.5?2*r*r:1-Math.pow(-2*r+2,2)/2,o=r=>{let d=r-n,l=Math.min(d/s,1),p=a(l),m=e+(t-e)*p;i.scrollLeft=m,l<1&&requestAnimationFrame(o)};requestAnimationFrame(o)}queueHeaderAdjustment(){this.isAdjustmentQueued||(this.isAdjustmentQueued=!0,requestAnimationFrame(()=>{this.adjustAllHeaders(),this.isAdjustmentQueued=!1}))}getAllHeaders(){return Array.from(document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header"))}getHeaderKey(i){let e=i.querySelector(".workspace-tab-header-inner-title");return(e==null?void 0:e.textContent)||""}measureTextWidth(i,e){if(!this.measureElement)return 0;let t=window.getComputedStyle(e);return this.measureElement.style.font=t.font,this.measureElement.style.letterSpacing=t.letterSpacing,this.measureElement.style.textTransform=t.textTransform,this.measureElement.style.fontWeight=t.fontWeight,this.measureElement.textContent=i,Math.ceil(this.measureElement.offsetWidth)+5}calculateHeaderWidth(i){let e=i.querySelector(".workspace-tab-header-inner-title");if(!e)return this.plugin.settings.minWidth;let t=this.measureTextWidth(e.textContent||"",e),s=this.plugin.settings.hideTabIcons?0:this.plugin.settings.iconWidth>0?this.plugin.settings.iconWidth:0,n=Math.ceil(Math.max(this.plugin.settings.leftPadding+s+t+this.plugin.settings.closeButtonLeftPadding+this.plugin.settings.closeButtonRightPadding,this.plugin.settings.minWidth));return this.plugin.settings.maxWidth>0?Math.min(n,this.plugin.settings.maxWidth):n}adjustAllHeaders(){if(this.isResetting)return;let i=this.getAllHeaders().filter(n=>{let a=n.closest(".workspace-tab-header-container"),o=a&&window.getComputedStyle(a).display!=="none",r=!n.classList.contains("icon-loading");return o&&r}),e=new Map,t=null,s=i.map(n=>{let a=this.getHeaderKey(n),o=this.plugin.settings.ignorePinnedTabs?n.querySelector(".workspace-tab-header-status-icon.mod-pinned"):null,r=this.plugin.settings.ignoreWebLinks?n.getAttribute("data-type")==="webviewer":!1,d=n.classList.contains("is-active"),l=this.tabWidthCache.get(a);return{header:n,headerKey:a,isPinned:!!o,isWebLink:r,isActive:d,cachedWidth:l,needsRecalc:l===void 0||d}});s.forEach(n=>{n.needsRecalc&&!n.isPinned&&!n.isWebLink&&(n.cachedWidth=this.calculateHeaderWidth(n.header))}),requestAnimationFrame(()=>{s.forEach(n=>{let{header:a,headerKey:o,isPinned:r,isWebLink:d,isActive:l,cachedWidth:p}=n;if(r||d){a.classList.remove("autofit-tab","autofit-max-width"),a.style.removeProperty("--header-width");return}let m=p,T=a.querySelectorAll(".workspace-tab-header-inner, .workspace-tab-header-inner-icon, .workspace-tab-header-inner-title");if(T.forEach(h=>{h instanceof HTMLElement&&(h.style.transition="none")}),a.classList.add("autofit-tab"),a.style.setProperty("--header-width",`${m}px`),e.set(o,m),this.plugin.settings.maxWidth>0&&m>=this.plugin.settings.maxWidth){a.classList.add("autofit-max-width");let h=Math.min(m,this.plugin.settings.maxWidth+20);a.style.setProperty("--header-width",`${h}px`)}else a.classList.remove("autofit-max-width");l&&(t=a),setTimeout(()=>{T.forEach(h=>{h instanceof HTMLElement&&(h.style.transition="")})},10)}),this.tabWidthCache=e,t?this.scrollToActiveTab(t):this.updateTabsVisibility()})}resetTabs(i){this.isResetting=!0;let e=this.getAllHeaders();e.forEach(t=>{t.classList.remove("autofit-max-width"),t.classList.remove("autofit-tab"),t.classList.remove("out-of-view"),t.classList.add("autofit-cleanup"),t.style.removeProperty("--header-width")}),this.tabWidthCache.clear(),setTimeout(()=>{e.forEach(t=>{t.classList.remove("autofit-cleanup")}),setTimeout(()=>{e.forEach(t=>{t.classList.add("autofit-tab")}),this.adjustAllHeaders(),this.updateTabsVisibility(),this.isResetting=!1},50)},100)}updateTabsVisibility(){this.isResetting||document.querySelectorAll(".workspace-split.mod-vertical.mod-root .workspace-tab-header-container-inner").forEach(i=>{if(i instanceof HTMLElement){let e=i.getBoundingClientRect(),t=e.left,s=e.right;Array.from(i.querySelectorAll(".workspace-tab-header.autofit-tab")).forEach(a=>{if(a instanceof HTMLElement){let o=a.getBoundingClientRect();o.right<t||o.left>s?a.classList.add("out-of-view"):a.classList.remove("out-of-view")}})}})}};var v=class extends y.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new b(this.app,this)),this.tabManager=new f(this),this.updateCSSVariables(),this.tabManager.initialize()}onunload(){this.tabManager.cleanup()}async loadSettings(){this.settings=Object.assign({},g,await this.loadData())}updateCSSVariables(){let e=this.settings.hideTabIcons?this.settings.leftPadding:this.settings.leftPadding,t={"--autofit-min-width":`${this.settings.minWidth}px`,"--autofit-left-padding":`${e}px`,"--autofit-close-button-left-padding":`${this.settings.closeButtonLeftPadding}px`,"--autofit-close-button-right-padding":`${this.settings.closeButtonRightPadding}px`,"--autofit-transition-duration":`${this.settings.transitionDuration}ms`,"--autofit-icon-width":this.settings.hideTabIcons?"0":`${this.settings.iconWidth}px`,"--autofit-icon-display":this.settings.hideTabIcons?"none":this.settings.iconWidth>0?"flex":"none","--autofit-max-width":this.settings.maxWidth>0?`${this.settings.maxWidth}px`:"none"};Object.entries(t).forEach(([s,n])=>{document.documentElement.style.setProperty(s,n)}),this.settings.hideTabIcons?document.body.classList.add("autofit-hide-tab-icons"):document.body.classList.remove("autofit-hide-tab-icons")}async saveSettings(){let e=this.settings.maxWidth;await this.saveData(this.settings),this.updateCSSVariables();let t=e>0&&this.settings.maxWidth===0;t?this.tabManager.resetTabs(t):this.tabManager.queueHeaderAdjustment()}};

/* nosourcemap */